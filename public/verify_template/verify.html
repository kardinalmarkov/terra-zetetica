<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <title>Zetetic Passport Verification</title>
  <style>
    body {
      font-family: "Segoe UI", sans-serif;
      background: #f0f4fb;
      color: #222;
      padding: 2em;
    }

    .container {
      max-width: 640px;
      background: white;
      padding: 2.5em;
      border-radius: 12px;
      margin: auto;
      box-shadow: 0 0 20px rgba(0,0,0,0.08);
    }

    h1 {
      text-align: center;
      color: #1a237e;
      font-size: 1.8em;
      margin-bottom: 1em;
    }

    .info-line {
      margin: 1em 0;
      font-size: 1.1em;
    }

    .info-line code {
      background: #eef1ff;
      padding: 0.3em 0.6em;
      border-radius: 5px;
      font-size: 1em;
    }

    .status {
      padding: 0.4em 0.8em;
      border-radius: 6px;
      font-weight: bold;
      display: inline-block;
    }

    .valid {
      background: #e6f4ea;
      color: #2e7d32;
      border: 1px solid #81c784;
    }

    .invalid {
      background: #ffebee;
      color: #c62828;
      border: 1px solid #ef5350;
    }

    .badge {
      font-size: 0.95em;
      color: #3949ab;
      margin-top: 0.4em;
    }

    footer {
      text-align: center;
      font-size: 0.85em;
      margin-top: 2em;
      color: #888;
    }

    #verify-form {
      margin-bottom: 2em;
      text-align: center;
    }

    input[type="text"] {
      padding: 0.5em;
      font-size: 1em;
      width: 80%;
      max-width: 400px;
      margin-bottom: 1em;
      border: 1px solid #ccc;
      border-radius: 6px;
    }

    button {
      padding: 0.5em 1em;
      font-size: 1em;
      background-color: #1a237e;
      color: white;
      border: none;
      border-radius: 6px;
      cursor: pointer;
    }

    button:hover {
      background-color: #303f9f;
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>üß≠ Zetetic Passport Verification</h1>

    <!-- üí° –§–æ—Ä–º–∞ —Ä—É—á–Ω–æ–≥–æ –≤–≤–æ–¥–∞ CID -->
    <div id="verify-form">
      <form id="cidForm">
        <input type="text" id="cidInput" placeholder="–í—Å—Ç–∞–≤—å—Ç–µ CID –ø–∞—Å–ø–æ—Ä—Ç–∞..." required />
        <br />
        <button type="submit">–ü—Ä–æ–≤–µ—Ä–∏—Ç—å</button>
      </form>
    </div>

    <!-- üßæ –†–µ–∑—É–ª—å—Ç–∞—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏ -->
    <div id="result">‚è≥ –û–∂–∏–¥–∞–Ω–∏–µ –≤–≤–æ–¥–∞...</div>
  </div>

  <footer>
    Terra Zetetica ‚Ä¢ Supra Veritas Ordo
  </footer>

  <script>
    // üëá –†—É—á–Ω–∞—è –æ—Ç–ø—Ä–∞–≤–∫–∞ —Ñ–æ—Ä–º—ã: –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞ —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–º ?cid=...
    document.getElementById('cidForm').addEventListener('submit', function (e) {
      e.preventDefault();
      const cid = document.getElementById('cidInput').value.trim();
      if (cid) {
        window.location.href = `verify.html?cid=${cid}`;
      }
    });

    // üëá –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞, –µ—Å–ª–∏ ?cid —É–∂–µ –µ—Å—Ç—å
    async function fetchPassportData(cid) {
      const gateway = "https://gateway.pinata.cloud/ipfs/";
      const url = gateway + cid;

      try {
        const res = await fetch(url);
        if (!res.ok) throw new Error("Not found");
        const data = await res.json();

        document.getElementById("result").innerHTML = `
          <div class="info-line"><strong>–ò–º—è:</strong> ${data.full_name}</div>
          <div class="info-line"><strong>Zetetic ID:</strong> <code>${data.zid}</code></div>
          <div class="info-line"><strong>–î–∞—Ç–∞ –≤—ã–¥–∞—á–∏:</strong> <code>${data.issued}</code></div>
          <div class="info-line"><strong>CID:</strong> <code>${cid}</code></div>
          <div class="info-line"><strong>–°—Ç–∞—Ç—É—Å:</strong> <span class="status ${data.status === 'active' ? 'valid' : 'invalid'}">${data.status}</span></div>
          <div class="badge">‚úì –î–æ–∫—É–º–µ–Ω—Ç –ø–æ–¥—Ç–≤–µ—Ä–∂–¥—ë–Ω —á–µ—Ä–µ–∑ IPFS</div>
        `;
      } catch (e) {
        document.getElementById("result").innerHTML = `<p class="status invalid">‚ùå –ü–∞—Å–ø–æ—Ä—Ç –Ω–µ –Ω–∞–π–¥–µ–Ω –∏–ª–∏ CID –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–µ–Ω.</p>`;
      }
    }

    const params = new URLSearchParams(window.location.search);
    const cid = params.get("cid");
    if (cid) {
      document.getElementById("cidInput").value = cid;
      fetchPassportData(cid);
    }
  </script>
</body>
</html>
